<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Job Applications Dashboard</title>



<style>
:root {
    --primary: #1f2937;
    --secondary: #374151;
    --accent: #2563eb;
    --bg: #f9fafb;
    --card: #ffffff;
    --border: #e5e7eb;
    --text: #111827;
}

/* Reset */
* {
    box-sizing: border-box;
}

body {
    margin: 0;
    font-family: "Inter", "Segoe UI", sans-serif;
    background: var(--bg);
    color: var(--text);
}

/* Header */
header {
    background: var(--primary);
    color: #fff;
    padding: 20px;
    text-align: center;
}

header h1 {
    margin: 0;
    font-size: 1.8rem;
}

/* Container */
.container {
    max-width: 1100px;
    margin: 30px auto;
    padding: 0 16px;
}

/* Card */
.card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 24px;
}

/* Button */
button {
    background: var(--accent);
    color: #fff;
    border: none;
    padding: 12px 24px;
    border-radius: 8px;
    font-size: 1rem;
    cursor: pointer;
    transition: background 0.2s ease;
}

button:hover {
    background: #1d4ed8;
}

/* Summary */
.summary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
    gap: 16px;
}

.summary-box {
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 16px;
    text-align: center;
}

.summary-box h3 {
    margin: 0;
    font-size: 0.9rem;
    color: var(--secondary);
}

.summary-box p {
    margin: 8px 0 0;
    font-size: 1.4rem;
    font-weight: 600;
}

/* Table */
.table-wrapper {
    width: 100%;
    overflow-x: auto;
}

table {
    width: 100%;
    border-collapse: collapse;
    min-width: 500px;
}

th, td {
    padding: 14px;
    text-align: left;
    border-bottom: 1px solid var(--border);
}

th {
    background: #f3f4f6;
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

tr:hover {
    background: #f9fafb;
}

/* Status */
.status {
    padding: 6px 12px;
    border-radius: 999px;
    font-size: 0.85rem;
    font-weight: 500;
    display: inline-block;
}

.Rejected { background: #fee2e2; color: #991b1b; }
.Assessment { background: #fef3c7; color: #92400e; }
.Interview { background: #dcfce7; color: #166534; }
.NoResponse { background: #e5e7eb; color: #374151; }

/* Loading Skeleton */
.skeleton {
    background: linear-gradient(
        90deg,
        #e5e7eb 25%,
        #f3f4f6 37%,
        #e5e7eb 63%
    );
    background-size: 400% 100%;
    animation: shimmer 1.4s ease infinite;
    border-radius: 6px;
}

@keyframes shimmer {
    0% { background-position: -400px 0; }
    100% { background-position: 400px 0; }
}

.skeleton-line {
    height: 16px;
    margin-bottom: 10px;
}
#footer {
    text-align: center;          /* Center the text */
    margin-top: 40px;            /* Space from the content above */
    font-size: 0.9rem;           /* Slightly smaller font */
    color: #555;                 /* Subtle gray color */
    font-style: italic;          /* Optional: make it italic */
}

/* Mobile */
@media (max-width: 600px) {
    header h1 {
        font-size: 1.4rem;
    }
}
</style>
</head>

<body>

<header>
    <h1>Job Applications Dashboard</h1>
</header>

<div class="container">

    <!-- Login -->
    <div id="login-section" class="card" style="text-align:center;">
        <button id="loginBtn">Login with Google</button>
    </div>

    <!-- Dashboard -->
    <div id="dashboard" style="display:none;">

        <!-- Summary -->
        <div class="card">
            <h2>Summary</h2>
            <div id="summary" class="summary-grid">
                <div class="summary-box skeleton"><div class="skeleton-line"></div></div>
                <div class="summary-box skeleton"><div class="skeleton-line"></div></div>
                <div class="summary-box skeleton"><div class="skeleton-line"></div></div>
                <div class="summary-box skeleton"><div class="skeleton-line"></div></div>
            </div>
        </div>

        <!-- Applications -->
        <div class="card">
            <h2>Applications</h2>
            <div id="applications">
                <div class="skeleton skeleton-line"></div>
                <div class="skeleton skeleton-line"></div>
                <div class="skeleton skeleton-line"></div>
            </div>
        </div>

    </div>
</div>
<footer id="footer">
    &copy; By Delisha
</footer>

<script>


const loginBtn = document.getElementById("loginBtn");
const loginSection = document.getElementById("login-section");
const dashboard = document.getElementById("dashboard");

loginBtn.onclick = () => {
    window.location.href = "/login";
};

async function loadData() {
    try {
        const res = await fetch("/analyze");

        if (res.status === 401) {
            loginSection.style.display = "block";
            dashboard.style.display = "none";
            return;
        }

        const data = await res.json();

        loginSection.style.display = "none";
        dashboard.style.display = "block";

        document.getElementById("summary").innerHTML = `
            <div class="summary-box"><h3>Rejected</h3><p>${data.summary.Rejected}</p></div>
            <div class="summary-box"><h3>Assessment</h3><p>${data.summary.Assessment}</p></div>
            <div class="summary-box"><h3>Interview</h3><p>${data.summary.Interview}</p></div>
            <div class="summary-box"><h3>No Response</h3><p>${data.summary["No Response"]}</p></div>
        `;

        if (data.applications.length === 0) {
            document.getElementById("applications").innerHTML = "<p>No applications found.</p>";
            return;
        }

        document.getElementById("applications").innerHTML = `
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th>Company</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${data.applications.map(a => `
                            <tr>
                                <td>${a.company}</td>
                                <td><span class="status ${a.status.replace(/\s/g,"")}">${a.status}</span></td>
                            </tr>
                        `).join("")}
                    </tbody>
                </table>
            </div>
        `;

    } catch (e) {
        console.error(e);
    }
}

loadData();
</script>

</body>
</html>
